<!DOCTYPE html><html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clima – 3 Dias (PALMARES-PE)</title>
<style>
  :root{
    --w: 575px;
    --h: 960px;
    --azul1:#0ea5e9;
    --azul2:#1e3a8a;
    --preto:#0b1020;
    --texto:#ffffff;
    --sombra: 0 0 24px rgba(14,165,233,0.45), 0 0 6px rgba(14,165,233,0.85);
  }
  html,body{height:100%;}
  body{
    margin:0;
    background:#001222;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,sans-serif;
    color:var(--texto);
    display:flex;
    align-items:flex-start; /* topo */
    justify-content:flex-start; /* esquerda */
    padding:10px; /* opcional: afastar um pouco da borda */
  }
  .totem{
    width:var(--w);height:var(--h);display:grid;grid-template-rows:80px 1fr;
    border:6px solid var(--azul1); border-radius:20px; box-shadow:var(--sombra); overflow:hidden;
    background:linear-gradient(180deg,#0ea5e9 0%, #0b69b1 100%);
  }
  .topo{
    display:grid;place-items:center; font-weight:800; font-size:48px; letter-spacing:0.5px;
    text-shadow:0 3px 0 rgba(0,0,0,.35); text-transform:uppercase;
  }
  .grade{display:grid; grid-template-rows: repeat(3, 1fr); gap:12px; padding:12px;}

  .card{
    position:relative; display:grid; grid-template-columns: 160px 1fr; align-items:center; gap:12px;
    background:radial-gradient(120% 140% at 0% 0%, #0c1228 30%, #0a0f1f 100%);
    border:4px solid #27b3ff; border-radius:16px; box-shadow:inset 0 0 24px rgba(39,179,255,.35);
  }
  .icone{width:160px; height:160px; display:grid; place-items:center;}
  .dados{padding-right:12px;}
  .linha1{
    display:flex; align-items:center; justify-content:flex-start;
    gap:16px;
    font-size:46px; font-weight:900;
  }
  .linha1 .dia{white-space:nowrap;}
  .linha1 .desc{font-size:34px; font-weight:700; opacity:.95; margin-left:12px;}
  .linha2{
    display:flex; align-items:center; justify-content:flex-start;
    font-size:40px; opacity:.95; margin-top:2px;
  }
  .maxmin{font-weight:650;}
  @keyframes girar { from{transform:rotate(0)} to{transform:rotate(360deg)} }
  @keyframes flutuar { 0%{transform:translateX(-3px)} 50%{transform:translateX(3px)} 100%{transform:translateX(-3px)} }
  @keyframes pingar { 0%{transform:translateY(-8px); opacity:0} 20%{opacity:1} 100%{transform:translateY(14px); opacity:0} }
  @keyframes relampago { 0%, 90%, 100%{opacity:.0} 10%, 12%, 14%{opacity:1} 30%{opacity:.0} 32%{opacity:1} 40%{opacity:.0} }
  svg{width:140px;height:140px}
  .sun{fill:#ffd166; filter:drop-shadow(0 0 8px rgba(255,209,102,.7));}
  .sun-rays{transform-origin:70px 70px; animation:girar 18s linear infinite;}
  .cloud{fill:#d9e6ff; opacity:.95; filter:drop-shadow(0 0 6px rgba(217,230,255,.45)); animation:flutuar 6s ease-in-out infinite;}
  .drop{fill:#7cc8ff; animation:pingar 800ms linear infinite;}
  .drop:nth-child(2){animation-delay:150ms}
  .drop:nth-child(3){animation-delay:350ms}
  .bolt{fill:#fee440; filter:drop-shadow(0 0 8px rgba(254,228,64,.9)); animation:relampago 3s infinite linear;}
</style>
</head>
<body>
  <div class="totem" id="widget">
    <div class="topo" id="cidade">PALMARES</div>
    <div class="grade" id="lista"></div>
  </div>

<script>
(async function(){
  const CIDADE = 'PALMARES';
  const LAT = -8.6842;
  const LON = -35.5911;
  const TIMEZONE = 'America/Recife';
  const DIAS = 3;
  const ATUALIZA_MIN = 15;

  const ptDias = ['Domingo','Segunda','Terça','Quarta','Quinta','Sexta','Sábado'];

  const wmoDesc = (code)=>{
    if([0].includes(code)) return 'Céu limpo';
    if([1,2].includes(code)) return 'Sol entre nuvens';
    if([3].includes(code)) return 'Nublado';
    if([45,48].includes(code)) return 'Neblina';
    if([51,53,55,56,57,61,63,65].includes(code)) return 'Chuva';
    if([80,81,82].includes(code)) return 'Pancadas de chuva';
    if([66,67,71,73,75,77,85,86].includes(code)) return 'Precipitação';
    if([95,96,99].includes(code)) return 'Tempestade';
    return 'Tempo variado';
  };

  const tipoIcone = (code)=>{
    if([0].includes(code)) return 'clear';
    if([1,2].includes(code)) return 'partly';
    if([3,45,48].includes(code)) return 'cloudy';
    if([51,53,55,56,57,61,63,65,80,81,82,66,67,71,73,75,77,85,86].includes(code)) return 'rain';
    if([95,96,99].includes(code)) return 'storm';
    return 'partly';
  };

  function svgIcon(kind){
    if(kind==='clear'){
      return `<svg viewBox="0 0 140 140" aria-hidden="true"><circle class="sun" cx="70" cy="70" r="28"/><g class="sun-rays">${Array.from({length:8}).map((_,i)=>{const a=i*45, x1=70+Math.cos(a*Math.PI/180)*38, y1=70+Math.sin(a*Math.PI/180)*38, x2=70+Math.cos(a*Math.PI/180)*48, y2=70+Math.sin(a*Math.PI/180)*48; return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="#ffd166" stroke-width="6" stroke-linecap="round"/>`}).join('')}</g></svg>`;
    }
    if(kind==='partly'){
      return `<svg viewBox="0 0 140 140" aria-hidden="true"><circle class="sun" cx="54" cy="50" r="24"/><g class="sun-rays">${Array.from({length:8}).map((_,i)=>{const a=i*45, x1=54+Math.cos(a*Math.PI/180)*32, y1=50+Math.sin(a*Math.PI/180)*32, x2=54+Math.cos(a*Math.PI/180)*40, y2=50+Math.sin(a*Math.PI/180)*40; return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="#ffd166" stroke-width="6" stroke-linecap="round"/>`}).join('')}</g><ellipse class="cloud" cx="96" cy="98" rx="34" ry="18"/><ellipse class="cloud" cx="70" cy="104" rx="28" ry="15"/></svg>`;
    }
    if(kind==='cloudy'){
      return `<svg viewBox="0 0 140 140" aria-hidden="true"><ellipse class="cloud" cx="60" cy="88" rx="34" ry="18"/><ellipse class="cloud" cx="100" cy="96" rx="38" ry="20"/></svg>`;
    }
    if(kind==='rain'){
      return `<svg viewBox="0 0 140 140" aria-hidden="true"><ellipse class="cloud" cx="92" cy="74" rx="34" ry="18"/><ellipse class="cloud" cx="62" cy="82" rx="30" ry="16"/><g><circle class="drop" cx="54" cy="108" r="4"/><circle class="drop" cx="76" cy="116" r="4"/><circle class="drop" cx="96" cy="110" r="4"/></g></svg>`;
    }
    if(kind==='storm'){
      return `<svg viewBox="0 0 140 140" aria-hidden="true"><ellipse class="cloud" cx="92" cy="74" rx="34" ry="18"/><ellipse class="cloud" cx="62" cy="82" rx="30" ry="16"/><polygon class="bolt" points="74,100 62,126 78,122 70,140 98,112 82,116 94,100"/></svg>`;
    }
    return '';
  }

  function montarCard({date, wcode, tmax, tmin}){
    const d = new Date(date + "T00:00:00");
    const semana = ptDias[d.getDay()];
    const tipo = tipoIcone(wcode);
    const desc = wmoDesc(wcode);
    return `<div class="card">
      <div class="icone">${svgIcon(tipo)}</div>
      <div class="dados">
        <div class="linha1"><span class="dia">${semana}</span><span class="desc">${desc}</span></div>
        <div class="linha2"><span class="maxmin">${Math.round(tmax)}° / ${Math.round(tmin)}°</span></div>
      </div>
    </div>`;
  }

  const hojeStrTZ = ()=> new Date().toLocaleDateString('en-CA', { timeZone: TIMEZONE });

  async function carregar(){
    document.getElementById('cidade').textContent = CIDADE;
    try{
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=${encodeURIComponent(TIMEZONE)}&past_days=0`;
      const r = await fetch(url, {cache:'no-store'});
      const j = await r.json();

      const hoje = hojeStrTZ();
      let startIndex = j.daily.time.indexOf(hoje);
      if(startIndex < 0) startIndex = 0;

      const out = [];
      for(let i=0; i<DIAS; i++){
        const idx = Math.min(startIndex + i, j.daily.time.length - 1);
        out.push(montarCard({
          date: j.daily.time[idx],
          wcode: j.daily.weathercode[idx],
          tmax: j.daily.temperature_2m_max[idx],
          tmin: j.daily.temperature_2m_min[idx]
        }));
      }
      document.getElementById('lista').innerHTML = out.join('');
    }catch(e){ console.error(e); }
  }

  await carregar();
  setInterval(carregar, ATUALIZA_MIN*60*1000);
})();
</script>
</body>
</html>